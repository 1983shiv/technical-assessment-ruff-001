# Frontend Technical Assessment - Payment Method Form

**Developer Level:** Senior  
**Industry Domain:** SaaS  
**Stack:** TypeScript + React + Zustand + Vitest  
**Difficulty:** Hard  

---

## ðŸ“˜ Problem Statement

**Business Context:**  
You are working for a SaaS company that provides a subscription-based dashboard for managing user accounts and billing. The product team wants to improve the billing experience by allowing users to update their payment method directly from the dashboard. The UI must handle real-world edge cases such as invalid card details, expired cards, network errors, and provide instant feedback. The payment method state should be managed using Zustand.

**Feature Requirement:**  
Implement a `PaymentMethodForm` React component that allows users to update their credit card information. The form should validate card number, expiry date, and CVC in real-time, handle submission errors gracefully, and update the global payment method state using Zustand. The component should be accessible, responsive, and follow UX best practices.

---

## ðŸ§© Code Skeleton

```tsx
// src/store/paymentMethodStore.ts
import create from 'zustand';

export type PaymentMethod = {
  cardNumber: string;
  expiry: string;
  cvc: string;
  last4?: string;
};

type PaymentMethodState = {
  method: PaymentMethod | null;
  setMethod: (method: PaymentMethod) => void;
  clearMethod: () => void;
};

export const usePaymentMethodStore = create<PaymentMethodState>((set) => ({
  method: null,
  setMethod: (method) => set({ method }),
  clearMethod: () => set({ method: null }),
}));

// src/components/PaymentMethodForm.tsx
import React, { useState } from 'react';
import { usePaymentMethodStore } from '../store/paymentMethodStore';

const validateCardNumber = (num: string) => {
  // TODO: Implement Luhn algorithm for card validation
  return true;
};

const validateExpiry = (expiry: string) => {
  // TODO: Validate MM/YY format and check if date is in the future
  return true;
};

const validateCVC = (cvc: string) => {
  // TODO: Validate CVC (3 or 4 digits)
  return true;
};

export const PaymentMethodForm: React.FC = () => {
  const { setMethod } = usePaymentMethodStore();
  const [cardNumber, setCardNumber] = useState('');
  const [expiry, setExpiry] = useState('');
  const [cvc, setCvc] = useState('');
  const [errors, setErrors] = useState<{ cardNumber?: string; expiry?: string; cvc?: string }>({});
  const [submitting, setSubmitting] = useState(false);
  const [submitError, setSubmitError] = useState<string | null>(null);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    // TODO: Validate all fields and set errors
    // TODO: Simulate async API call, handle network errors
    // TODO: On success, update payment method in store
  };

  return (
    <form onSubmit={handleSubmit} aria-label="Update Payment Method">
      <label>
        Card Number
        <input
          type="text"
          value={cardNumber}
          onChange={(e) => setCardNumber(e.target.value)}
          aria-invalid={!!errors.cardNumber}
          aria-describedby="cardNumber-error"
          maxLength={19}
          autoComplete="cc-number"
        />
      </label>
      {errors.cardNumber && <span id="cardNumber-error">{errors.cardNumber}</span>}

      <label>
        Expiry (MM/YY)
        <input
          type="text"
          value={expiry}
          onChange={(e) => setExpiry(e.target.value)}
          aria-invalid={!!errors.expiry}
          aria-describedby="expiry-error"
          maxLength={5}
          autoComplete="cc-exp"
        />
      </label>
      {errors.expiry && <span id="expiry-error">{errors.expiry}</span>}

      <label>
        CVC
        <input
          type="text"
          value={cvc}
          onChange={(e) => setCvc(e.target.value)}
          aria-invalid={!!errors.cvc}
          aria-describedby="cvc-error"
          maxLength={4}
          autoComplete="cc-csc"
        />
      </label>
      {errors.cvc && <span id="cvc-error">{errors.cvc}</span>}

      <button type="submit" disabled={submitting}>
        {submitting ? 'Updating...' : 'Update Payment Method'}
      </button>
      {submitError && <div role="alert">{submitError}</div>}
    </form>
  );
};
```

---

## âœ… Testing Expectations

- **Unit Tests:**  
  - Validate card number, expiry, and CVC logic (including edge cases: invalid formats, expired dates, short/long CVC).
  - Test form error rendering and accessibility attributes.
  - Test store updates on successful submission.

- **Integration Test (Vitest + React Testing Library):**

```tsx
// src/components/PaymentMethodForm.test.tsx
import { render, screen, fireEvent, waitFor } from '@testing-library/react';
import { PaymentMethodForm } from './PaymentMethodForm';
import { usePaymentMethodStore } from '../store/paymentMethodStore';

describe('PaymentMethodForm', () => {
  beforeEach(() => {
    usePaymentMethodStore.getState().clearMethod();
  });

  it('renders all input fields and submit button', () => {
    render(<PaymentMethodForm />);
    expect(screen.getByLabelText(/Card Number/i)).toBeInTheDocument();
    expect(screen.getByLabelText(/Expiry/i)).toBeInTheDocument();
    expect(screen.getByLabelText(/CVC/i)).toBeInTheDocument();
    expect(screen.getByRole('button')).toBeInTheDocument();
  });

  it('shows error for invalid card number', async () => {
    render(<PaymentMethodForm />);
    fireEvent.change(screen.getByLabelText(/Card Number/i), { target: { value: '123' } });
    fireEvent.click(screen.getByRole('button'));
    await waitFor(() => {
      expect(screen.getByText(/Invalid card number/i)).toBeInTheDocument();
    });
  });

  it('updates store on valid submission', async () => {
    render(<PaymentMethodForm />);
    fireEvent.change(screen.getByLabelText(/Card Number/i), { target: { value: '4242424242424242' } });
    fireEvent.change(screen.getByLabelText(/Expiry/i), { target: { value: '12/30' } });
    fireEvent.change(screen.getByLabelText(/CVC/i), { target: { value: '123' } });
    fireEvent.click(screen.getByRole('button'));
    await waitFor(() => {
      expect(usePaymentMethodStore.getState().method?.cardNumber).toBe('4242424242424242');
    });
  });

  // TODO: Add tests for expired card, invalid expiry format, network error simulation, accessibility checks
});
```

---

## ðŸ’¡ Optional Bonus

- Implement Luhn algorithm for card validation.
- Add loading spinner and disable form during submission.
- Handle network/API errors with user-friendly messages.
- Ensure full keyboard navigation and screen reader support.
- Make the form responsive for mobile and desktop.
- Mask card number input for privacy.
- Add i18n support for error messages.

---

This assessment is unique and tailored for a senior SaaS front-end developer using React, TypeScript, Zustand, and Vitest.